<!DOCTYPE html><html lang="en"><head><link href="http://fonts.googleapis.com/css?family=PT+Sans:400,700|PT+Serif:400,700" rel="stylesheet" type="text/css"><!-- Meta--><meta charset="utf-8"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Blog | Brisk Bee</title><meta name="description" content="Casual rants on mobile development"><meta name="keywords" content="briskbee, haldbæk, peter haldbæk, peter haldbaek, iphone, ios, android, findantenna, dvb-t, java, mobile, development"><meta name="author" content="Peter Haldbæk"><meta name="generator" content="DocPad v6.78.6" /><meta name="viewport" content="width=device-width"><!-- Icons--><link rel="shortcut icon" href="/ico/favicon.ico"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="/ico/apple-touch-icon-144-precomposed.png"><link rel="apple-touch-icon-precomposed" sizes="114x114" href="/ico/apple-touch-icon-114-precomposed.png"><link rel="apple-touch-icon-precomposed" sizes="72x72" href="/ico/apple-touch-icon-72-precomposed.png"><link rel="apple-touch-icon-precomposed" href="/ico/apple-touch-icon-57-precomposed.png"><!--if lt IE 9script(async src="http://html5shim.googlecode.com/svn/trunk/html5.js")
--><!-- Styles--><link  rel="stylesheet" href="/vendor/prettify.css" /><link  rel="stylesheet" href="/vendor/bootstrap/css/bootstrap.min.css" /><link  rel="stylesheet" href="/styles/style.css" /></head><body><!-- Markup--><header><div class="container"><div class="row"><div class="col-md-2 visible-md visible-lg"></div><div class="col-md-8"><div class="background"><div class="top"><a href="/">Brisk Bee</a></div><nav class="topmenu"><ul class="list-inline"><li class="active"><a href="/">BLOG</a></li><li typeof="sioc:Page" about="/pages/about/"><a href="/pages/about/" property="dc:title">About</a></li></ul></nav></div></div><div class="col-md-2 visible-md visible-lg"></div></div></div></header><div class="container"><div class="row"><div class="col-md-2"></div><div class="col-md-8"><section id="content" class="content"><ul class="posts"><li><article id="doc" class="even post"><h1><a href="/posts/find_antenna_officially_released/">Find Antenna officially released</a></h1><div class="pubdate">Published February 28th 2013</div><div class="post-content"><p>My very first mobile app was officially released yesterday. I have spent many evenings on ridiculous details and I am happy to say that the app is ready at last. The app can be used to determine the 5 closest DVB-T transmitters and in which direction they can be found. It is very useful if you want to figure out which way your TV antenna should point. It uses the location of the mobile phone to determine which transmitters are closest and the compass to determine the direction.</p>
<p>
  <img class="img-responsive" style="width: 400px;" src="/posts/find_antenna_officially_released/screenshot.png" alt="Find Antenna Android screenshot">
  <p>
    <a href="https://play.google.com/store/apps/details?id=com.briskbee.master">
      <img alt="Get it on Google Play"
           src="https://developer.android.com/images/brand/en_generic_rgb_wo_60.png" />
    </a>
  </p>
</p>

<p>The app is currently only available for Android. You can find at Google Play by clicking the icon above.</p>
</div></article></li><li><article id="doc" class="odd post"><h1><a href="/posts/setting_character_set_to_utf8_in_mysql/">Setting character set to UTF-8 in MySQL</a></h1><div class="pubdate">Published October 25th 2012</div><div class="post-content"><p>The default installation of MySQL (5.5) does not use UTF-8 so every time I install an instance of MySQL I spend some time tinkering with the character setup so I decided to write a quick summary of the steps needed in order for MySQL to support UTF-8.  When you have a vanilla installation of MySQL you can check your character settings by executing these commands.  </p>
<pre><code>mysql&gt; show variables like &#39;char%&#39;;
+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8                       |
| character_set_connection | utf8                       |
| character_set_database   | latin1                     |
| character_set_filesystem | binary                     |
| character_set_results    | utf8                       |
| character_set_server     | latin1                     |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+

mysql&gt; show variables like &#39;collation%&#39;;
+----------------------+-------------------+
| Variable_name        | Value             |
+----------------------+-------------------+
| collation_connection | utf8_general_ci   |
| collation_database   | latin1_swedish_ci |
| collation_server     | latin1_swedish_ci |
+----------------------+-------------------+
</code></pre><p>As we can see latin1 is used in several places. This should be changed to UTF-8. You can do this by either editing your existing my.cnf configuration file or creating a new configuration file in the conf.d folder of your MySQL configuration (recommended). I create a new configuration file at conf.d/utf8.cnf which looks like this.  </p>
<pre><code>[mysqld]
character-set-server = utf8
character-set-client = utf8
</code></pre><p>Restart the server.</p>
<pre><code>&gt; sudo service mysql restart
</code></pre><p>Log in to MySQL and check that everything is ok.  </p>
<pre><code>mysql&gt; show variables like &#39;char%&#39;;
+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8                       |
| character_set_connection | utf8                       |
| character_set_database   | utf8                       |
| character_set_filesystem | binary                     |
| character_set_results    | utf8                       |
| character_set_server     | utf8                       |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+

mysql&gt; show variables like &#39;collation%&#39;;
+----------------------+-----------------+
| Variable_name        | Value           |
+----------------------+-----------------+
| collation_connection | utf8_general_ci |
| collation_database   | utf8_general_ci |
| collation_server     | utf8_general_ci |
+----------------------+-----------------+
</code></pre><p>Everything is now using UTF-8.  </p>
<h2 id="update-21-11-2012">Update 21.11.2012</h2>
<p>If you want to use utf8_unicode_ci instead of utf8_general_ci (you probably
want that, see
<a href="http://stackoverflow.com/questions/766809/whats-the-difference-between-utf8-general-ci-and-utf8-unicode-ci">this</a>)
then add the following to the my.cnf file in the mysqld section and restart the
server.  </p>
<pre><code>collation-server = utf8_unicode_ci
</code></pre><h2 id="update-21-11-2012-a-little-later-">Update 21.11.2012 (a little later)</h2>
<p>The collation settings should be something like this.</p>
<pre><code>mysql&gt; show variables like &#39;collation%&#39;;
+----------------------+-----------------+
| Variable_name        | Value           |
+----------------------+-----------------+
| collation_connection | utf8_general_ci |
| collation_database   | utf8_unicode_ci |
| collation_server     | utf8_unicode_ci |
+----------------------+-----------------+
</code></pre><p>I previously had the impression that it should be <code>utf8_unicode_ci</code>
for all collation variables (obtained by setting the
<code>skip-character-set-client-handshake</code> option in my.cnf) but this
generated weird behavior when comparing dates in the database.</p>
</div></article></li><li><article id="doc" class="even post"><h1><a href="/posts/creating_insert_statements_from_table_data/">Creating insert statements from table data</a></h1><div class="pubdate">Published October 23rd 2012</div><div class="post-content"><p>Creating a SQL script which inserts data from an already existing table is not as straightforward as one would think. I found a pretty clean and easy solution which I will explain in detail here. I use MySQL but I believe the principles can be applied to most other databases if needed.  Consider table A with the following content.  </p>
<table class="table">
  <thead>
    <tr><th>Id</th><th>Name</th></tr>
  </thead>
  <tbody>
    <tr><td>1</td><td>Peter</td></tr>
    <tr><td>2</td><td>Jake</td></tr>
    <tr><td>3</td><td>Paul</td></tr>
  </tbody>
</table>

<p>I want to create a script inserting all entries where name starts with P. The first step is to create a table containing these entries.</p>
<pre><code>CREATE TABLE b (SELECT FROM a WHERE name LIKE &#39;P%&#39;);
</code></pre><p>Now the data can be exported using mysqldump.  </p>
<pre><code>&gt; mysqldump -p -u &lt;username&gt; &lt;database&gt; b &gt; insert-script.sql
</code></pre><p>The created script contains statements which will drop and create the table (among other things). Normally I am only interested in the part where the insert statements are so open the created script file and remove everything except the <code>INSERT INTO</code> statement. Also remember to rename the name of the table where the data is to be inserted to the correct table name (table A in my case).  The final script file should look something like this.  </p>
<pre><code>INSERT INTO a VALUES (1, &#39;Peter&#39;),(&#39;3&#39;, &#39;Paul&#39;);
</code></pre><p>Finally you should drop the temporary table you created.</p>
</div></article></li><li><article id="doc" class="odd post"><h1><a href="/posts/accessing_memory_database_in_play_/">Accessing memory database in Play!</a></h1><div class="pubdate">Published September 11th 2012</div><div class="post-content"><p>The other day I was running some unit tests in an app using the <a href="http://www.playframework.org/">Play! framework</a> and I wanted to see how the data in the database looked like. Tests are run using a H2 memory database so accessing this was not as straightforward as I am used to since most configuration in Play! is done by convention (or magic, not sure which). So I did not know the connection string to the database nor the credentials used by the framework. After some <a href="http://stackoverflow.com/questions/6265957/access-mem-or-fs-database-tables-using-h2-console">googling</a> I came across the information needed.</p>
<p>First start your test and when you are at a breakpoint open the database browser supplied by Play! at localhost:9000/@db (this was new to me as well). Select the Generic Server option and use these parameters.</p>
<table class="table">
  <thead>
    <tr><th>Parameter</th><th>Value</th></tr>
  </thead>
  <tbody>
    <tr><td>JDBC URL</td><td>jdbc:h2:mem:play</td></tr>
    <tr><td>User Name</td><td>sa</td></tr>
    <tr><td>Password</td><td>&lt;none&gt;</td></tr>
  </tbody>
</table>

<p>You should now be able to access the database used by your tests.</p>
</div></article></li><li><article id="doc" class="even post"><h1><a href="/posts/changing_unnamed_constraints_in_play_/">Changing unnamed constraints in Play!</a></h1><div class="pubdate">Published August 11th 2012</div><div class="post-content"><p>I have been working on a project based on the <a href="http://www.playframework.org/">Play! framework</a> lately (the old version, <a href="http://www.playframework.org/documentation/1.2.4/home">1.2.4</a>) and I came across a real headscratcher. My problem was I needed to delete a foreign constraint in a table but this constraint had no name (it was not given a name when it was created). Deleting a constraint with standard SQL requires a name so I had to do come up with something else for my evolution script. I was using <a href="http://www.mysql.com/">MySQL</a> in production and <a href="http://www.h2database.com/">H2</a> in test so it was not an option to use some MySQL specific code unless it was compatible with H2.</p>
<p>Let&#39;s make a little example first to illustrate my problem. Consider these two tables:</p>
<pre><code>CREATE TABLE a (
    id INTEGER NOT NULL AUTO_INCREMENT,
    CONSTRAINT pk_a PRIMARY KEY(id)
);
CREATE TABLE b (
    id INTEGER NOT NULL AUTO_INCREMENT,
    a_id INTEGER NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY(a_id) REFERENCES a(id)
);
</code></pre><p>Table B has a foreign constraint for the column a_id which points to the id column in the A table. If I wanted to delete the foreign constraint I should execute this statement:</p>
<pre><code>ALTER TABLE b DROP CONSTRAINT &quot;constraint name&quot;
</code></pre><p>But since the foreign constraint was not named initially I cannot use this statement. My next thought was to find a way to list all the foreign constraints of the table and then use the result as input to an alter table statement. I did not find any way to do this with standard SQL but using some MySQL-specific SQL I actually managed to do this. The select query looks like this:</p>
<pre><code>SELECT
    constraint_name,
    CONCAT(table_name, &#39;.&#39;, column_name) AS &#39;foreign key&#39;,
    CONCAT(referenced_table_name, &#39;.&#39;, referenced_column_name) AS &#39;references&#39;
FROM
    information_schema.key_column_usage
WHERE
    referenced_table_name IS NOT NULL;
</code></pre><p>This lists all foreign key constraints in the database. I tried executing it in H2 and to no surprise it did not work.</p>
<p>I decided not to change the existing table but instead create a new table (without constraints) and copy the contents of the old table to the new table. If you need to keep the name of the table as it was you could always rename the table but since the naming of the table was a bit off in my case I actually ended up with a better named table anyway. And I am not sure renaming a table is supported by standard SQL.</p>
<p>So lets first create a new table without the constraints:</p>
<pre><code>CREATE TABLE b_new (
    id INTEGER NOT NULL AUTO_INCREMENT,
    a_id INTEGER NOT NULL,
    CONSTRAINT pk_b PRIMARY KEY(id)
);
</code></pre><p>Then copy the data from the old to the new table:</p>
<pre><code>INSERT INTO b_new SELECT * FROM b ORDER BY id;
</code></pre><p>The last thing to do is to delete the old table (and maybe renaming the new one):</p>
<pre><code>DROP TABLE b;
</code></pre><p>That&#39;s it. Now the table has no foreign constraints.</p>
<p>So if you need a reason for why you always should name your constraints, now you know why.</p>
</div></article></li></ul><ul class="pager"><li class="previous"><a href="/">Newer</a></li><li class="next"><a href="/3">Older</a></li></ul><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'briskbee'; // required: replace example with your forum shortname
var disqus_identifier = 'index';
var disqus_title = 'Blog';
var disqus_url = 'http://briskbee.com/2';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());</script></section></div><div class="col-md-2"></div></div></div><footer><div class="container"><div class="row"><div class="col-md-2 visible-md visible-lg"></div><div class="col-md-8"><ui class="list-inline"><li><a href="/pages/about">About</a></li></ui><div class="pull-right">© Brisk Bee 2018</div></div><div class="col-md-2 visible-md visible-lg"></div></div></div></footer><!-- Scripts--><script defer="defer"  src="/vendor/prettify.js"></script><script defer="defer"  src="/vendor/jquery/jquery.min.js"></script><script defer="defer"  src="/vendor/bootstrap/js/bootstrap.min.js"></script><script defer="defer"  src="/vendor/log.js"></script><script defer="defer"  src="/vendor/modernizr.js"></script><script defer="defer"  src="/scripts/script.js"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-18789185-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></body></html>